<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ìë™ì°¨ êµì‚¬ ì „ìš© - ì—‘ì…€ êµìœ¡ê³¼ì • ë¶„ì„ê¸°</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; padding: 20px; line-height: 1.6; background-color: #f4f7f6; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        h2 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; }
        .upload-box { border: 2px dashed #3498db; padding: 20px; text-align: center; border-radius: 8px; margin-bottom: 20px; background: #ebf5fb; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #3498db; color: white; width: 30%; }
        .subject-list { list-style: none; padding: 0; }
        .subject-list li { margin-bottom: 5px; padding: 5px; background: #eee; border-radius: 4px; font-size: 14px; }
        .highlight { font-weight: bold; color: #e74c3c; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸš— êµìœ¡ê³¼ì • ì—‘ì…€ ë°ì´í„° ë¶„ì„ (Dashboard)</h2>
    <div class="upload-box">
        <p>ë¶„ì„í•  ì—‘ì…€ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš” (.xlsx / .xls)</p>
        <input type="file" id="excelFile" accept=".xlsx, .xls" />
    </div>

    <div id="resultArea" style="display:none;">
        <table>
            <tr><th>1. í›ˆë ¨ê¸°ê°„</th><td id="res1">-</td></tr>
            <tr><th>2. ì´ í›ˆë ¨ì‹œê°„</th><td id="res2" class="highlight">-</td></tr>
            <tr><th>3. í›ˆë ¨êµì‚¬</th><td id="res3">-</td></tr>
            <tr><th>4. êµê³¼ëª© ì œëª© (ì¤‘ë³µì œì™¸)</th><td id="res4"></td></tr>
            <tr><th>5. ì´ êµê³¼ëª© ìˆ˜</th><td id="res5" class="highlight">-</td></tr>
            <tr><th>6. ê³¼ëª©ë³„ ì´ ì‹œê°„</th><td id="res6"></td></tr>
            <tr><th>7. ìš”ì¼ë³„ ë°°ì¹˜ í˜„í™©</th><td id="res7"></td></tr>
        </table>
    </div>
</div>

<script>
document.getElementById('excelFile').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(event) {
        const data = new Uint8Array(event.target.result);
        const workbook = XLSX.read(data, {type: 'array'});
        
        // ì²« ë²ˆì§¸ ì‹œíŠ¸ ì„ íƒ
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        
        // ë°ì´í„°ë¥¼ JSON í˜•íƒœë¡œ ë³€í™˜
        const jsonData = XLSX.utils.sheet_to_json(sheet);
        
        analyzeData(jsonData);
    };
    reader.readAsArrayBuffer(file);
});

function analyzeData(data) {
    document.getElementById('resultArea').style.display = 'block';

    // ë¶„ì„ì„ ìœ„í•œ ë³€ìˆ˜ë“¤
    let totalHours = data.length; // ê° í–‰ì´ 1ì‹œê°„ì´ë¼ê³  ê°€ì •
    let teachers = new Set();
    let subjects = new Map(); // ê³¼ëª©ë³„ ì‹œê°„ í•©ê³„ìš©
    let weekDays = { 'ì›”': [], 'í™”': [], 'ìˆ˜': [], 'ëª©': [], 'ê¸ˆ': [] };
    let startDate = data[0]?.ë‚ ì§œ || 'ë°ì´í„° ì—†ìŒ';
    let endDate = data[data.length - 1]?.ë‚ ì§œ || 'ë°ì´í„° ì—†ìŒ';

    data.forEach(row => {
        // ì—‘ì…€ì˜ í—¤ë”(ì œëª©)ê°€ 'êµì‚¬', 'ê³¼ëª©', 'ìš”ì¼' ë“±ì´ë¼ê³  ê°€ì •í•˜ê³  ì¶”ì¶œ
        // ì„ ìƒë‹˜ì˜ ì‹¤ì œ ì—‘ì…€ í—¤ë” ëª…ì¹­ì— ë§ì¶° ìˆ˜ì •ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        if(row.í›ˆë ¨êµì‚¬) teachers.add(row.í›ˆë ¨êµì‚¬);
        if(row.êµê³¼ëª©) {
            subjects.set(row.êµê³¼ëª©, (subjects.get(row.êµê³¼ëª©) || 0) + 1);
        }
        if(row.ìš”ì¼ && row.êµê³¼ëª©) {
            if(!weekDays[row.ìš”ì¼]?.includes(row.êµê³¼ëª©)) {
                weekDays[row.ìš”ì¼]?.push(row.êµê³¼ëª©);
            }
        }
    });

    // 1. í›ˆë ¨ê¸°ê°„
    document.getElementById('res1').innerText = `${startDate} ~ ${endDate}`;
    
    // 2. ì´ í›ˆë ¨ì‹œê°„
    document.getElementById('res2').innerText = totalHours + " ì‹œê°„";
    
    // 3. í›ˆë ¨êµì‚¬
    document.getElementById('res3').innerText = Array.from(teachers).join(', ');

    // 4 & 5. êµê³¼ëª© ì •ë³´
    const subjectNames = Array.from(subjects.keys());
    document.getElementById('res4').innerHTML = `<ul class="subject-list">` + subjectNames.map(s => `<li>${s}</li>`).join('') + `</ul>`;
    document.getElementById('res5').innerText = subjectNames.length + " ê°œ ê³¼ëª©";

    // 6. ê° êµê³¼ëª© ë‹¹ í›ˆë ¨ ì‹œê°„
    let subjectHoursHTML = '<ul class="subject-list">';
    subjects.forEach((hours, name) => {
        subjectHoursHTML += `<li>${name}: <span class="highlight">${hours}ì‹œê°„</span></li>`;
    });
    document.getElementById('res6').innerHTML = subjectHoursHTML + '</ul>';

    // 7. ìš”ì¼ë³„ êµê³¼ëª©
    let weekHTML = '<ul class="subject-list">';
    for(let day in weekDays) {
        weekHTML += `<li><strong>${day}ìš”ì¼:</strong> ${weekDays[day].join(', ') || 'ìˆ˜ì—… ì—†ìŒ'}</li>`;
    }
    document.getElementById('res7').innerHTML = weekHTML + '</ul>';
}
</script>

</body>
</html>