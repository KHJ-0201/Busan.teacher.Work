<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>관리자 설정 - 자동차 CBT</title>
    <link rel="stylesheet" href="A_style.css">
    <style>
        .empty-field { background-color: #fff0f0 !important; border: 2px solid #ffcccc !important; }
        .filled-field { background-color: #ffffff !important; border: 1px solid #ddd !important; }
    </style>
</head>
<body>
    <nav class="nav-menu">
        <span id="currentClassBanner" style="float: left; font-weight: bold; color: #2c3e50; padding: 5px 15px; background: #fff; border-radius: 5px; border: 1px solid #ddd; margin-left: 10px;">접속 반: 확인 중...</span>
        <div style="display: inline-block; margin-right: 20px;">
            <button onclick="location.href='A_Admin.html'" class="small-btn navy" style="background:#2c3e50;">설정(A)</button>
            <button onclick="location.href='B_Exam.html'" class="small-btn navy" style="background:#2980b9;">응시(B)</button>
            <button onclick="location.href='C_Result.html'" class="small-btn navy" style="background:#27ae60;">결과(C)</button>
        </div>
        <div style="display: inline-block; margin-left: 20px; border-left: 1px solid #ccc; padding-left: 20px;">
            <select id="importClassSelect" class="small-btn" style="background: white; color: black; height: 28px; vertical-align: middle;">
                <option value="">불러올 반 선택</option>
                <option value="501반">501반</option><option value="601반">601반</option><option value="602반">602반</option>
                <option value="603반">603반</option><option value="701반">701반</option><option value="702반">702반</option><option value="703반">703반</option>
            </select>
            <button onclick="importClassData()" class="small-btn gray" style="background: #16a085;">데이터 가져오기</button>
        </div>
    </nav>

    <div class="admin-container">
        <h1>🛠 CBT 교육 과정 관리</h1>
        <div class="fixed-info-box">
            <h3 style="margin-top:0; border-bottom:1px solid #ccc; padding-bottom:10px; margin-bottom:20px;">🏫 학급 기본 설정</h3>
            <div class="info-row">
                <div class="input-item flex-grow"><label>훈련과정:</label><input type="text" id="groupName" class="wide-input check-empty" placeholder="훈련 과정명을 입력하세요" oninput="checkInputStatus(this); saveFixedInfo();"></div>
                <div class="input-item"><label>교육 기간:</label><input type="text" id="groupPeriod" class="check-empty" placeholder="예: 2025.08.04.~2026.02.04." oninput="checkInputStatus(this); saveFixedInfo();"></div>
            </div>
            <div class="info-row" style="margin-top: 15px;">
                <div class="input-item"><label>담당교사:</label><input type="text" id="teacherName" class="check-empty" placeholder="성함" oninput="checkInputStatus(this); saveFixedInfo();" style="width: 80px;"><label style="margin-left:10px;">직인:</label><input type="file" id="teacherStamp" accept="image/*" onchange="saveStampImage('teacher')" style="width: 150px;"><div id="teacherStampPrev" class="stamp-preview"></div></div>
                <div class="input-item" style="margin-left: 20px;"><label>검증자:</label><input type="text" id="verifierName" class="check-empty" placeholder="성함" oninput="checkInputStatus(this); saveFixedInfo();" style="width: 80px;"><label style="margin-left:10px;">직인:</label><input type="file" id="verifierStamp" accept="image/*" onchange="saveStampImage('verifier')" style="width: 150px;"><div id="verifierStampPrev" class="stamp-preview"></div></div>
            </div>
        </div>

        <div class="view-control-panel"><div class="view-tabs"><button id="viewBySubjectBtn" class="tab-btn active" onclick="switchView('subject')">📂 세분류별 보기</button><button id="viewByDateBtn" class="tab-btn" onclick="switchView('date')">📅 날짜순으로 보기</button></div></div>
        <div class="vertical-layout">
            <div class="subject-section ncs-section">
                <div class="header-row" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; border-bottom:2px solid #2980b9; padding-bottom:5px;"><h3 style="margin:0; color:#2980b9;">📘 NCS 세분류 리스트</h3><button onclick="createMainSubject('ncs')" class="small-btn navy" style="background:#2980b9; padding:8px 15px;">+ NCS 세분류 추가</button></div>
                <div id="ncsSubjectContainer" class="subject-container-vertical"></div>
            </div>
            <div class="subject-section non-ncs-section">
                <div class="header-row" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; border-bottom:2px solid #e67e22; padding-bottom:5px;"><h3 style="margin:0; color:#e67e22;">📙 비NCS 세분류 리스트</h3><button onclick="createMainSubject('non-ncs')" class="small-btn navy" style="background:#e67e22; padding:8px 15px;">+ 비NCS 세분류 추가</button></div>
                <div id="nonNcsSubjectContainer" class="subject-container-vertical"></div>
            </div>
        </div>
        <div id="dateViewContainer" class="date-view-box" style="display:none;"><div id="dateViewList"></div></div>
    </div>
    <div class="backup-area"><button onclick="exportBackup()" class="small-btn navy">📤 전체 데이터 백업</button><button onclick="document.getElementById('backupFile').click()" class="small-btn gray">📥 백업파일 복구</button><input type="file" id="backupFile" style="display:none;" onchange="importBackup(this)"></div>
    <button class="final-save-btn" onclick="saveAllData()">💾 설정 저장하기</button>

    <script src="A_script.js"></script>
    <script>
        function checkInputStatus(el) { if (!el) return; if (el.value.trim() === "") { el.classList.add('empty-field'); el.classList.remove('filled-field'); } else { el.classList.add('filled-field'); el.classList.remove('empty-field'); } }
        window.addEventListener('load', () => { setTimeout(() => { document.querySelectorAll('input[type="text"], textarea, select').forEach(el => { if(el.id !== 'importClassSelect' && el.id !== 'backupFile') checkInputStatus(el); }); }, 500); });
    </script>
</body>
</html>